"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// MIT Â© 2017 azu
var an_1 = require("./an");
var a_1 = require("./a");
var testWord = function (text, pattern) {
    if (typeof pattern === "string") {
        return text === pattern;
    }
    else {
        return pattern.test(text);
    }
};
function classifyArticle(phrase, options) {
    // Getting the first word
    var match = /[\w.-]+/.exec(phrase);
    var word = match ? match[0] : undefined;
    if (word === undefined) {
        return {
            type: "unknown",
            reason: "Not found any phase."
        };
    }
    // User-defined words
    if (options && options.forceA) {
        for (var i = 0; i < options.forceA.length; i++) {
            var forceA = options.forceA[i];
            if (forceA === word) {
                return {
                    type: "a",
                    reason: "User defined words that should be proceeded by 'a'"
                };
            }
        }
    }
    if (options && options.forceAn) {
        for (var i = 0; i < options.forceAn.length; i++) {
            var forceAn = options.forceAn[i];
            if (forceAn === word) {
                return {
                    type: "an",
                    reason: "User defined words that should be proceeded by 'an'"
                };
            }
        }
    }
    var lowerWord = word.toLowerCase();
    // Specific start of words that should be proceeded by 'an'
    var specialAnCaseWords = an_1.AnPatterns;
    for (var i = 0; i < specialAnCaseWords.length; i++) {
        var specialAnCaseWordPattern = specialAnCaseWords[i];
        if (testWord(word, specialAnCaseWordPattern)) {
            return {
                type: "an",
                reason: "Specific start of words that should be proceeded by 'an'"
            };
        }
    }
    // Single letter word which should be proceeded by 'an'
    if (lowerWord.length == 1) {
        if ("aefhilmnorsx".indexOf(lowerWord) >= 0) {
            return {
                type: "an",
                reason: "Single letter word which should be proceeded by 'an'"
            };
        }
        else {
            return {
                type: "a",
                reason: "Single letter word which should be proceeded by 'a'"
            };
        }
    }
    // Special cases where a word that begins with a vowel should be proceeded by 'a'
    var specialACasePattern = a_1.APattern;
    for (var i = 0; i < specialACasePattern.length; i++) {
        var specialACaseWordPattern = specialACasePattern[i];
        if (testWord(word, specialACaseWordPattern)) {
            return {
                type: "a",
                reason: "Special cases where a word that begins with a vowel should be proceeded by 'a'"
            };
        }
    }
    // Special capital words (UK, UN)
    if (/^U[NK][AIEO]?/.test(word)) {
        return {
            type: "a",
            reason: "Special capital words (UK, UN)"
        };
    }
    else if (word == word.toUpperCase()) {
        // All Capital words which is not special case would be unknown
        if (/^[A-Z.]+$/.test(word)) {
            return {
                type: "unknown",
                reason: "Capital words which is not special case would be unknown"
            };
        }
        // start with alphabet vowel
        if ("aefhilmnorsx".indexOf(lowerWord[0]) >= 0) {
            return {
                type: "an",
                reason: "Words that begin with a alphabet vowel being proceeded by 'an'"
            };
        }
        else if ("bcfhjkqrst".indexOf(lowerWord[0]) >= 0) {
            return {
                type: "a",
                reason: "Words that begin with a alphabet vowel being proceeded by 'a'"
            };
        }
    }
    // Basic method of words that begin with a vowel being proceeded by 'an'
    if ("aeiou".indexOf(lowerWord[0]) >= 0) {
        return {
            type: "an",
            reason: "Basic method of words that begin with a vowel being proceeded by 'an'"
        };
    }
    // Instances where y followed by specific letters is proceeded by 'an'
    if (lowerWord.match(/^y(b[lor]|cl[ea]|fere|gg|p[ios]|rou|tt)/)) {
        return {
            type: "an",
            reason: "Instances where y followed by specific letters is proceeded by 'an'"
        };
    }
    return {
        type: "a",
        reason: "Other words that begins with a vowel should be proceeded by 'a'"
    };
}
exports.classifyArticle = classifyArticle;
//# sourceMappingURL=english-article-classifier.js.map